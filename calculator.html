<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –≤–∞—Ä—Ç–æ—Å—Ç—ñ –∞–≤—Ç–æ ‚Äî Auto GBP</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –æ—Ä—ñ—î–Ω—Ç–æ–≤–Ω–æ—ó –≤–∞—Ä—Ç–æ—Å—Ç—ñ –∞–≤—Ç–æ –∑ –°–®–ê —Ç–∞ –Ñ–≤—Ä–æ–ø–∏ –≤—ñ–¥ Auto GBP (Grand Best Performance)." />

  <style>
    :root{
      --bg:#050608;--border:#262935;--gold:#ffd86a;--gold-soft:#e4c45a;
      --text:#f7f7f7;--muted:#9a9a9a;--success:#65d96b;
      --radius-lg:18px;--radius-sm:8px;--shadow-soft:0 18px 40px rgba(0,0,0,.7);
    }
    *{box-sizing:border-box}
    body{
      margin:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:radial-gradient(circle at top,#141821 0,#020308 55%);
      color:var(--text);-webkit-font-smoothing:antialiased;
    }
    a{color:var(--gold);text-decoration:none}
    .container{width:min(1120px,100% - 32px);margin:0 auto}

    .top-bar{
      position:sticky;top:0;z-index:10;backdrop-filter:blur(18px);
      background:linear-gradient(to bottom,rgba(5,6,8,.96),rgba(5,6,8,.88));
      border-bottom:1px solid rgba(255,216,106,.18);
    }
    .top-bar-inner{display:flex;align-items:center;justify-content:space-between;padding:10px 0;gap:16px}
    .logo{display:flex;align-items:center;gap:10px}
    .logo-mark{
      width:34px;height:34px;border-radius:50%;
      background:radial-gradient(circle at 30% 20%,#ffeaa0,#c69528);
      display:flex;align-items:center;justify-content:center;
      box-shadow:0 0 0 1px rgba(0,0,0,.6),0 0 18px rgba(255,216,106,.55);
      overflow:hidden;
    }
    .logo-mark img{width:120%;height:auto;display:block}
    .logo-text-main{font-size:18px;letter-spacing:3px;font-weight:800}
    .logo-text-sub{font-size:11px;color:var(--muted)}
    .nav-links{display:flex;gap:14px;font-size:14px;flex-wrap:wrap}
    .nav-links a{
      color:var(--muted);padding:6px 10px;border-radius:999px;border:1px solid transparent;
      transition:.18s ease;white-space:nowrap
    }
    .nav-links a:hover{color:var(--text);border-color:rgba(255,216,106,.5);background:rgba(255,216,106,.05)}
    .nav-links .active{color:#000;font-weight:700;background:var(--gold);box-shadow:0 0 18px rgba(255,216,106,.55)}

    .page-hero{padding:26px 0 10px}
    .page-hero h1{font-size:26px;margin:0 0 6px}
    .page-hero p{margin:0;color:var(--muted);font-size:14px;max-width:900px}

    .layout{padding-bottom:40px}
    .grid{display:grid;grid-template-columns:minmax(0,3.2fr) minmax(0,2.3fr);gap:18px;align-items:flex-start}
    @media (max-width:900px){.grid{grid-template-columns:minmax(0,1fr)}}

    .card{
      background:radial-gradient(circle at top left,#1a1a22,#05050a);
      border-radius:var(--radius-lg);padding:18px 16px 16px;
      border:1px solid rgba(255,255,255,.05);box-shadow:var(--shadow-soft);
    }
    .card h2{font-size:18px;margin:0 0 4px}
    .card p.sub{margin:0 0 14px;font-size:13px;color:var(--muted)}
    .section-title{margin-top:16px;margin-bottom:8px;font-size:15px}

    .fields-row{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px}
    @media (max-width:640px){.fields-row{grid-template-columns:minmax(0,1fr)}}

    label{display:block;font-size:13px;color:var(--muted);margin-bottom:4px}
    input,select{
      width:100%;padding:9px 10px;border-radius:var(--radius-sm);
      border:1px solid var(--border);background:rgba(9,11,18,.95);
      color:var(--text);font-size:14px;outline:none;
      transition:border-color .16s ease,box-shadow .16s ease,background .16s ease;
    }
    input:focus,select:focus{border-color:var(--gold-soft);box-shadow:0 0 0 1px rgba(255,216,106,.4);background:#10121b}
    input::placeholder{color:rgba(154,154,154,.7)}
    .hint{font-size:11px;color:var(--muted);margin-top:2px;line-height:1.35}

    .chips{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
    .chip{
      display:inline-flex;align-items:center;gap:6px;font-size:11px;padding:6px 10px;border-radius:999px;
      border:1px solid rgba(255,216,106,.22);background:rgba(255,216,106,.06);color:rgba(255,216,106,.95)
    }
    .chip.ok{border-color:rgba(101,217,107,.28);background:rgba(101,217,107,.05);color:rgba(101,217,107,.95)}

    .btn-primary{
      display:inline-flex;align-items:center;justify-content:center;gap:8px;width:100%;
      padding:11px 20px;border-radius:999px;border:none;cursor:pointer;
      background:linear-gradient(135deg,#ffd86a,#c69528);color:#000;font-size:14px;font-weight:900;
      box-shadow:0 12px 30px rgba(0,0,0,.8);margin-top:12px;transition:.12s ease;
    }
    .btn-primary:hover{filter:brightness(1.03)}
    .btn-primary:active{transform:translateY(1px)}

    .btn-ghost{
      display:inline-flex;align-items:center;justify-content:center;gap:8px;width:100%;
      padding:10px 14px;border-radius:999px;cursor:pointer;margin-top:10px;
      border:1px solid rgba(255,216,106,.25);background:rgba(255,216,106,.06);
      color:var(--text);font-size:13px;font-weight:900;transition:.15s ease;
    }
    .btn-ghost:hover{border-color:rgba(255,216,106,.55);background:rgba(255,216,106,.10)}
    .btn-ghost:active{transform:translateY(1px)}

    .pdf-btn{
      display:inline-flex;align-items:center;justify-content:center;gap:8px;width:100%;
      padding:11px 14px;border-radius:999px;cursor:pointer;margin-top:10px;
      border:1px solid rgba(255,216,106,.35);
      background:linear-gradient(135deg, rgba(255,216,106,.20), rgba(198,149,40,.12));
      color:var(--text);font-size:13px;font-weight:950;transition:.15s ease;
      position:relative;overflow:hidden;
    }
    .pdf-btn::before{
      content:"";position:absolute;inset:-45%;
      background:radial-gradient(circle at 20% 20%, rgba(255,216,106,.35), transparent 55%);
      transform:rotate(12deg);opacity:.8;
    }
    .pdf-btn span{position:relative;z-index:1}
    .pdf-btn:hover{border-color:rgba(255,216,106,.70);background:linear-gradient(135deg, rgba(255,216,106,.28), rgba(198,149,40,.16))}
    .pdf-btn:active{transform:translateY(1px)}

    .btn-row{display:flex;gap:10px}
    @media (max-width:640px){.btn-row{flex-direction:column}}

    .note{margin-top:8px;font-size:11px;color:var(--muted);line-height:1.5}

    .result-header{display:flex;align-items:baseline;justify-content:space-between;gap:10px;margin-bottom:6px}
    .result-main{font-size:26px;font-weight:1000;letter-spacing:.2px}
    .result-tag{font-size:11px;padding:2px 8px;border-radius:999px;border:1px solid rgba(255,255,255,.12);color:var(--muted)}
    .result-block{margin-top:10px;padding-top:8px;border-top:1px dashed rgba(255,255,255,.08);font-size:13px}
    .result-row{display:flex;justify-content:space-between;margin-bottom:3px;gap:10px}
    .result-row span:first-child{color:var(--muted)}
    .result-row span:last-child{font-variant-numeric:tabular-nums}
    .result-highlight{margin-top:7px;padding-top:7px;border-top:1px solid rgba(255,216,106,.25);font-weight:950}
    .result-ok{color:var(--success);font-weight:950;margin-top:2px}
    .tiny{font-size:11px;color:var(--muted);margin-top:6px;line-height:1.35}
    .pill{
      display:inline-flex;align-items:center;gap:6px;font-size:11px;padding:4px 8px;border-radius:999px;
      background:rgba(27,211,120,.05);border:1px solid rgba(101,217,107,.35);margin-top:10px;color:rgba(101,217,107,.95)
    }

    .pulse{animation:pulse .35s ease}
    @keyframes pulse{from{transform:scale(.995);opacity:.85}to{transform:scale(1);opacity:1}}

    footer{border-top:1px solid rgba(255,255,255,.04);padding:12px 0 20px;font-size:11px;color:var(--muted);text-align:center}

    /* ---------- PDF SHEET (hidden, used for branded export) ---------- */
    #pdf-sheet {
      position: fixed;
      left: -9999px;
      top: 0;
      width: 794px; /* ~A4 at 96dpi */
      min-height: 1123px;
      background: #07080d;
      color: #f7f7f7;
      padding: 34px 34px 30px;
      border-radius: 18px;
      border: 1px solid rgba(255,216,106,.18);
      box-shadow: 0 30px 80px rgba(0,0,0,.55);
      font-family: system-ui,-apple-system,"Segoe UI",sans-serif;
    }
    .pdf-top{
      display:flex;justify-content:space-between;align-items:flex-start;gap:18px;
      padding-bottom:16px;border-bottom:1px solid rgba(255,216,106,.18);
      margin-bottom:16px;
    }
    .pdf-brand{display:flex;gap:12px;align-items:center}
    .pdf-logo{
      width:44px;height:44px;border-radius:50%;
      background: radial-gradient(circle at 30% 20%, #ffeaa0, #c69528);
      display:flex;align-items:center;justify-content:center;
      overflow:hidden;
      box-shadow:0 0 0 1px rgba(0,0,0,.55), 0 0 18px rgba(255,216,106,.35);
    }
    .pdf-logo img{width:120%;height:auto;display:block}
    .pdf-name{font-weight:1000;letter-spacing:3px;font-size:18px}
    .pdf-sub{font-size:12px;color:#b6b6b6;margin-top:2px}
    .pdf-meta{text-align:right}
    .pdf-meta .pdf-title{
      font-size:14px;font-weight:900;color:#ffd86a;margin-bottom:6px;
    }
    .pdf-meta .pdf-small{font-size:11px;color:#b6b6b6;line-height:1.35}
    .pdf-box{
      border:1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.03);
      border-radius:14px;
      padding:14px;
      margin-bottom:14px;
    }
    .pdf-box h3{
      margin:0 0 8px;
      font-size:13px;
      color:#ffd86a;
      letter-spacing:.6px;
    }
    .pdf-row{
      display:flex;justify-content:space-between;gap:12px;
      font-size:12px;padding:5px 0;border-bottom:1px dashed rgba(255,255,255,.08);
    }
    .pdf-row:last-child{border-bottom:none}
    .pdf-left{color:#cfcfcf}
    .pdf-right{font-variant-numeric:tabular-nums;font-weight:800}
    .pdf-total{
      display:flex;justify-content:space-between;gap:12px;
      padding-top:10px;margin-top:8px;
      border-top:1px solid rgba(255,216,106,.25);
      font-weight:1000;font-size:14px;
    }
    .pdf-footer{
      margin-top:16px;
      display:flex;justify-content:space-between;gap:14px;align-items:flex-end;
      border-top:1px solid rgba(255,255,255,.06);
      padding-top:14px;
    }
    .pdf-contacts{font-size:11px;color:#b6b6b6;line-height:1.45}
    .pdf-contacts b{color:#ffd86a}
    .pdf-note{
      font-size:10.5px;color:#9ea0a9;line-height:1.35;
      max-width:520px;
    }
    .pdf-link{
      font-size:10.5px;color:#ffd86a;
      word-break: break-all;
      margin-top:6px;
    }
  </style>
</head>

<body>
  <header class="top-bar">
    <div class="container top-bar-inner">
      <a href="index.html" class="logo">
        <div class="logo-mark"><img src="logo-gbp.png" alt="–õ–æ–≥–æ—Ç–∏–ø Auto GBP" /></div>
        <div>
          <div class="logo-text-main">AUTO GBP</div>
          <div class="logo-text-sub">Grand Best Performance ¬∑ Dubno</div>
        </div>
      </a>
      <nav class="nav-links">
        <a href="index.html#services">–ü–æ—Å–ª—É–≥–∏</a>
        <a href="index.html#how">–Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î</a>
        <a href="cars.html">–ê–≤—Ç–æ –≤ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ</a>
        <a href="calculator.html" class="active">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</a>
        <a href="index.html#request">–ó–∞—è–≤–∫–∞</a>
        <a href="index.html#contact">–ö–æ–Ω—Ç–∞–∫—Ç–∏</a>
      </nav>
    </div>
  </header>

  <main class="layout">
    <section class="container page-hero">
      <h1>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –≤–∞—Ä—Ç–æ—Å—Ç—ñ –∞–≤—Ç–æ –∑ –°–®–ê —Ç–∞ –Ñ–≤—Ä–æ–ø–∏</h1>
      <p>
        –ë–∞–∑–∞ –¥–ª—è –º–∏—Ç–∞/–ü–î–í: <b>—Ü—ñ–Ω–∞ –∞–≤—Ç–æ + –∞—É–∫—Ü—ñ–æ–Ω–Ω—ñ –∑–±–æ—Ä–∏ + –ª–æ–≥—ñ—Å—Ç–∏–∫–∞ –¥–æ –ø—É–Ω–∫—Ç—É –ø—Ä–∏–±—É—Ç—Ç—è</b>.
        –ü–æ—Ä—Ç–æ–≤—ñ –≤–∏—Ç—Ä–∞—Ç–∏, –ø–æ—Å–ª—É–≥–∏ Auto GBP —ñ –±–∞–Ω–∫—ñ–≤—Å—å–∫—ñ –ø–ª–∞—Ç–µ–∂—ñ ‚Äî <b>–æ–∫—Ä–µ–º–æ</b>.
        –Ñ <b>–ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫</b> —Ç–∞ <b>–±—Ä–µ–Ω–¥–æ–≤–∞–Ω–∏–π PDF</b>.
      </p>
      <div class="chips">
        <span class="chip ok">‚úÖ –ë–µ–∑ —á–µ—Ä–≤–æ–Ω–∏—Ö –ø–æ–∑–Ω–∞—á–æ–∫</span>
        <span class="chip">‚Ç¥ –ü–æ–∫–∞–∑—É—î –ø—ñ–¥—Å—É–º–æ–∫ —É –≥—Ä–∏–≤–Ω—ñ</span>
        <span class="chip">üßæ –ë—Ä–µ–Ω–¥–æ–≤–∞–Ω–∏–π PDF ‚Äú–ø–æ-–±–∞–≥–∞—Ç–æ–º—É‚Äù</span>
      </div>
    </section>

    <section class="container">
      <div class="grid">

        <!-- LEFT -->
        <div class="card">
          <h2>–í–≤–µ–¥–∏ –¥–∞–Ω—ñ</h2>
          <p class="sub">
            –í—Å—Ç–∞–≤ –ª—ñ–Ω–∫ –Ω–∞ Copart/IAAI ‚Äî —Ä–æ–∑–ø—ñ–∑–Ω–∞—î–º–æ –∞—É–∫—Ü—ñ–æ–Ω —Ç–∞ ID. ‚ÄúWinning Bid‚Äù –Ω–∞ GitHub Pages –∞–≤—Ç–æ–º–∞—Ç–æ–º –Ω–µ —Ç—è–≥–Ω–µ—Ç—å—Å—è —Å—Ç–∞–±—ñ–ª—å–Ω–æ, —Ç–æ–º—É –≤–≤–æ–¥–∏—à –π–æ–≥–æ –≤—Ä—É—á–Ω—É.
          </p>

          <form id="calc-form" autocomplete="off">
            <h2 class="section-title">0) –õ–æ—Ç –∑ –∞—É–∫—Ü—ñ–æ–Ω—É</h2>

            <div class="fields-row">
              <div>
                <label for="auctionUrl">–ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –ª–æ—Ç (Copart/IAAI)</label>
                <input id="auctionUrl" name="auctionUrl" type="url" placeholder="https://www.copart.com/lot/82324705 –∞–±–æ https://www.iaai.com/VehicleDetail/43925874~US" />
                <div class="hint">–†–æ–∑–ø—ñ–∑–Ω–∞—î –∞—É–∫—Ü—ñ–æ–Ω + ID —Ç–∞ –¥–æ–¥–∞—Å—Ç—å —É PDF/–ø–æ—Å–∏–ª–∞–Ω–Ω—è.</div>
              </div>
              <div>
                <label>&nbsp;</label>
                <div class="btn-row">
                  <button class="btn-ghost" type="button" id="applyAuctionUrlBtn">üîé –†–æ–∑–ø—ñ–∑–Ω–∞—Ç–∏ –ª–æ—Ç</button>
                  <button class="btn-primary" type="button" id="copyLinkBtn">üîó –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è</button>
                </div>
                <div class="tiny" id="auctionStatus"></div>
              </div>
            </div>

            <h2 class="section-title">1) –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –∞–≤—Ç–æ</h2>

            <div class="fields-row">
              <div>
                <label for="year">–†—ñ–∫ –≤–∏–ø—É—Å–∫—É</label>
                <input type="number" id="year" name="year" min="1995" max="2035" placeholder="2020" />
              </div>
              <div>
                <label for="fuel">–¢–∏–ø –ø–∞–ª–∏–≤–∞</label>
                <select id="fuel" name="fuel">
                  <option value="gasoline">–ë–µ–Ω–∑–∏–Ω</option>
                  <option value="diesel">–î–∏–∑–µ–ª—å</option>
                  <option value="hybrid">–ì—ñ–±—Ä–∏–¥</option>
                  <option value="electric">–ï–ª–µ–∫—Ç—Ä–æ</option>
                </select>
              </div>
            </div>

            <div class="fields-row">
              <div>
                <label for="engine">–û–± º—î–º –¥–≤–∏–≥—É–Ω–∞, —Å–º¬≥</label>
                <input type="number" id="engine" name="engine" placeholder="2000" />
                <div class="hint">–î–ª—è –µ–ª–µ–∫—Ç—Ä–æ –º–æ–∂–Ω–∞ 0 ‚Äî –∞–∫—Ü–∏–∑ –±—É–¥–µ 0.</div>
              </div>
              <div>
                <label for="auction">–ê—É–∫—Ü—ñ–æ–Ω</label>
                <select id="auction" name="auction">
                  <option value="Copart">Copart</option>
                  <option value="IAAI">IAAI</option>
                  <option value="Manheim">Manheim</option>
                  <option value="other">–Ü–Ω—à–∏–π</option>
                </select>
              </div>
            </div>

            <h2 class="section-title">2) –í–∞—Ä—Ç—ñ—Å—Ç—å —Ç–∞ –ª–æ–≥—ñ—Å—Ç–∏–∫–∞</h2>

            <div class="fields-row">
              <div>
                <label for="lotPrice">Winning Bid (—Ü—ñ–Ω–∞ –≤–∏–≥—Ä–∞—à—É), $</label>
                <input type="number" id="lotPrice" name="lotPrice" placeholder="20000" />
                <div class="hint">–í—Ö–æ–¥–∏—Ç—å —É –±–∞–∑—É –º–∏—Ç–∞/–ü–î–í.</div>
              </div>
              <div>
                <label for="auctionFee">–ê—É–∫—Ü—ñ–æ–Ω–Ω—ñ –∑–±–æ—Ä–∏, $</label>
                <input type="number" id="auctionFee" name="auctionFee" placeholder="1200" />
                <div class="hint">–í—Ö–æ–¥–∏—Ç—å —É –±–∞–∑—É –º–∏—Ç–∞/–ü–î–í.</div>
              </div>
            </div>

            <div class="fields-row">
              <div>
                <label for="shipUsa">–î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ —Å—É—à—ñ –°–®–ê, $</label>
                <input type="number" id="shipUsa" name="shipUsa" placeholder="–¥–æ –ø–æ—Ä—Ç—É" />
                <div class="hint">–í—Ö–æ–¥–∏—Ç—å —É –±–∞–∑—É –º–∏—Ç–∞/–ü–î–í.</div>
              </div>
              <div>
                <label for="shipSea">–ú–æ—Ä—Å—å–∫–∞ –¥–æ—Å—Ç–∞–≤–∫–∞, $</label>
                <input type="number" id="shipSea" name="shipSea" placeholder="1350" />
                <div class="hint">–í—Ö–æ–¥–∏—Ç—å —É –±–∞–∑—É –º–∏—Ç–∞/–ü–î–í.</div>
              </div>
            </div>

            <div class="fields-row">
              <div>
                <label for="euPort">–ü–æ—Ä—Ç / –º—ñ—Å—Ç–æ –ø—Ä–∏–±—É—Ç—Ç—è</label>
                <select id="euPort" name="euPort">
                  <option value="Klaipeda">–ö–ª–∞–π–ø–µ–¥–∞ (LT)</option>
                  <option value="Gdansk">–ì–¥–∞–Ω—Å—å–∫ (PL)</option>
                  <option value="Bremerhaven">–ë—Ä–µ–º–µ—Ä—Ö–∞—Ñ–µ–Ω (DE)</option>
                  <option value="Rotterdam">–†–æ—Ç—Ç–µ—Ä–¥–∞–º (NL)</option>
                  <option value="Chornomorsk">–ß–æ—Ä–Ω–æ–º–æ—Ä—Å—å–∫ (UA)</option>
                  <option value="Other">–Ü–Ω—à–µ</option>
                </select>
              </div>
              <div>
                <label for="euCurrency">–í–∞–ª—é—Ç–∞ –≤–∏—Ç—Ä–∞—Ç –Ñ–°</label>
                <select id="euCurrency" name="euCurrency">
                  <option value="USD">USD ($)</option>
                  <option value="EUR">EUR (‚Ç¨)</option>
                </select>
                <div class="hint">–Ø–∫—â–æ EUR ‚Äî –≤–∏—Ç—Ä–∞—Ç–∏ –Ñ–° –∫–æ–Ω–≤–µ—Ä—Ç—É—é—Ç—å—Å—è –≤ USD.</div>
              </div>
            </div>

            <div class="fields-row">
              <div>
                <label for="eurUsd">–ö—É—Ä—Å EUR ‚Üí USD (—è–∫—â–æ EUR)</label>
                <input type="number" id="eurUsd" name="eurUsd" step="0.01" value="1.10" placeholder="1.10" />
              </div>
              <div>
                <label for="shipEuLand">–î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ —Å—É—à—ñ –≤ –Ñ–° (–¥–æ –ø—É–Ω–∫—Ç—É)</label>
                <input type="number" id="shipEuLand" name="shipEuLand" placeholder="350" />
                <div class="hint">–í—Ö–æ–¥–∏—Ç—å —É –±–∞–∑—É –º–∏—Ç–∞/–ü–î–í.</div>
              </div>
            </div>

            <div class="fields-row">
              <div>
                <label for="portFees">–ü–æ—Ä—Ç–æ–≤—ñ/—Ç–µ—Ä–º—ñ–Ω–∞–ª—å–Ω—ñ –≤–∏—Ç—Ä–∞—Ç–∏</label>
                <input type="number" id="portFees" name="portFees" placeholder="–µ–∫—Å–ø–µ–¥–∏—Ç–æ—Ä —É –ø–æ—Ä—Ç—É" />
                <div class="hint">–ù–µ –≤—Ö–æ–¥—è—Ç—å —É –º–∏—Ç–æ/–ü–î–í. –î–æ–¥–∞—é—Ç—å—Å—è –≤ –ø—ñ–¥—Å—É–º–æ–∫.</div>
              </div>
              <div>
                <label for="shipUa">–î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –£–∫—Ä–∞—ó–Ω—ñ, $</label>
                <input type="number" id="shipUa" name="shipUa" placeholder="–¥–æ Dubno / —ñ–Ω—à–æ–≥–æ –º—ñ—Å—Ç–∞" />
              </div>
            </div>

            <div class="fields-row">
              <div>
                <label for="dealerFee">–ü–æ—Å–ª—É–≥–∏ Auto GBP, $</label>
                <input type="number" id="dealerFee" name="dealerFee" placeholder="700" />
                <div class="hint">–ù–µ –≤—Ö–æ–¥—è—Ç—å —É –º–∏—Ç–æ/–ü–î–í.</div>
              </div>
              <div>
                <label for="servicePackage">–ö–æ–º–ø–ª–µ–∫—Å –ø–æ—Å–ª—É–≥, $</label>
                <input type="number" id="servicePackage" name="servicePackage" placeholder="–æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è/–ª–æ–≥—ñ—Å—Ç–∏–∫–∞" />
                <div class="hint">–ù–µ –≤—Ö–æ–¥—è—Ç—å —É –º–∏—Ç–æ/–ü–î–í.</div>
              </div>
            </div>

            <h2 class="section-title">3) –ü–æ–¥–∞—Ç–∫–∏ —Ç–∞ —ñ–Ω—à–µ</h2>

            <div class="fields-row">
              <div>
                <label for="dutyRate">–ú–∏—Ç–æ, %</label>
                <input type="number" id="dutyRate" name="dutyRate" value="10" placeholder="10" />
              </div>
              <div>
                <label for="vatRate">–ü–î–í, %</label>
                <input type="number" id="vatRate" name="vatRate" value="20" placeholder="20" />
              </div>
            </div>

            <div class="fields-row">
              <div>
                <label for="cert">–°–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è, $</label>
                <input type="number" id="cert" name="cert" placeholder="0" />
              </div>
              <div>
                <label for="reg">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è/–æ–±–ª—ñ–∫, $</label>
                <input type="number" id="reg" name="reg" placeholder="0" />
              </div>
            </div>

            <div class="fields-row">
              <div>
                <label for="repair">–†–µ–º–æ–Ω—Ç, $</label>
                <input type="number" id="repair" name="repair" placeholder="0" />
              </div>
              <div>
                <label for="insurance">–°—Ç—Ä–∞—Ö—É–≤–∞–Ω–Ω—è, $</label>
                <input type="number" id="insurance" name="insurance" placeholder="0" />
              </div>
            </div>

            <div class="fields-row">
              <div>
                <label for="other">–Ü–Ω—à—ñ –≤–∏—Ç—Ä–∞—Ç–∏, $</label>
                <input type="number" id="other" name="other" placeholder="–¥—Ä—ñ–±–Ω—ñ –ø–ª–∞—Ç–µ–∂—ñ" />
              </div>
              <div>
                <label for="usdToUah">–ö—É—Ä—Å $ ‚Üí –≥—Ä–Ω</label>
                <input type="number" id="usdToUah" name="usdToUah" step="0.01" placeholder="–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ 42" />
                <div class="hint">–ü–æ–∫–∞–∂–µ –ø—ñ–¥—Å—É–º–æ–∫ –≤ –≥—Ä–∏–≤–Ω—ñ.</div>
              </div>
            </div>

            <h2 class="section-title">4) –ë–∞–Ω–∫—ñ–≤—Å—å–∫—ñ/–¥–æ–∫—É–º–µ–Ω—Ç–∞–ª—å–Ω—ñ</h2>

            <div class="fields-row">
              <div>
                <label for="swiftFee">SWIFT, $</label>
                <input type="number" id="swiftFee" name="swiftFee" value="200" />
              </div>
              <div>
                <label for="payDocsFee">–ü–ª–∞—Ç—ñ–∂–∫–∏, $</label>
                <input type="number" id="payDocsFee" name="payDocsFee" value="95" />
              </div>
            </div>

            <div class="fields-row">
              <div>
                <label for="transferLtFee">–ü–µ—Ä–µ–∫–∞–∑ –∫–æ—à—Ç—ñ–≤ –≤ –õ–∏—Ç–≤—É, $</label>
                <input type="number" id="transferLtFee" name="transferLtFee" value="85" />
              </div>
              <div>
                <label for="legalEntityFee">–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ —é—Ä.–æ—Å–æ–±—É, $</label>
                <input type="number" id="legalEntityFee" name="legalEntityFee" value="250" />
              </div>
            </div>

            <button type="button" class="btn-primary" id="scrollToResult">–ü–æ–∫–∞–∑–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç</button>

            <p class="note">
              –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –æ—Ä—ñ—î–Ω—Ç–æ–≤–Ω–∏–π. –î–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø—Ä–æ—Ä–∞—Ö—É–Ω–∫—É –ø—ñ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –ª–æ—Ç ‚Äî –Ω–∞–ø–∏—à–∏ –Ω–∞–º (Telegram/Viber).
            </p>
          </form>
        </div>

        <!-- RIGHT -->
        <aside class="card" id="result-card">
          <div class="result-header">
            <div>
              <div class="result-main" id="total-usd">0 $</div>
              <div class="result-ok" id="total-uah"></div>
              <div class="tiny" id="route-line"></div>
              <div class="tiny" id="lot-line"></div>
            </div>
            <div class="result-tag">–û—Ä—ñ—î–Ω—Ç–æ–≤–Ω–∞ –ø–æ–≤–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å</div>
          </div>

          <div class="result-block">
            <div class="result-row"><span>–ë–∞–∑–∞ –¥–ª—è –º–∏—Ç–∞/–ü–î–í</span><span id="customs-base">0 $</span></div>
            <div class="result-row"><span>–ú–∏—Ç–æ</span><span id="duty">0 $</span></div>
            <div class="result-row"><span>–ê–∫—Ü–∏–∑ (–æ—Ä—ñ—î–Ω—Ç–æ–≤–Ω–æ)</span><span id="excise">0 $</span></div>
            <div class="result-row"><span>–ü–î–í</span><span id="vat">0 $</span></div>
            <div class="result-row result-highlight"><span>–ü–æ–¥–∞—Ç–∫–∏ —Ä–∞–∑–æ–º</span><span id="taxes-total">0 $</span></div>

            <div class="result-row"><span>–ü–æ—Ä—Ç–æ–≤—ñ/—Ç–µ—Ä–º—ñ–Ω–∞–ª—å–Ω—ñ</span><span id="port-only">0 $</span></div>
            <div class="result-row"><span>–ü–æ—Å–ª—É–≥–∏ Auto GBP</span><span id="gbp-services">0 $</span></div>
            <div class="result-row"><span>–ë–∞–Ω–∫—ñ–≤—Å—å–∫—ñ –ø–ª–∞—Ç–µ–∂—ñ</span><span id="bank-fees">0 $</span></div>
            <div class="result-row"><span>–£–∫—Ä–∞—ó–Ω–∞ + —Å–µ—Ä—Ç/–æ–±–ª—ñ–∫/—Ä–µ–º–æ–Ω—Ç/—ñ–Ω—à–µ</span><span id="extras">0 $</span></div>

            <div class="result-row result-highlight"><span>–†–∞–∑–æ–º ¬´–ø—ñ–¥ –∫–ª—é—á¬ª</span><span id="grand-total">0 $</span></div>

            <div class="pill">‚ö° –ê–≤—Ç–æ–æ–Ω–æ–≤–ª–µ–Ω–Ω—è —É–≤—ñ–º–∫–Ω–µ–Ω–æ</div>

            <div class="btn-row">
              <button class="btn-ghost" type="button" id="copySummaryBtn">üìã –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫</button>
              <button class="btn-ghost" type="button" id="copyLinkBtn2">üîó –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è</button>
            </div>

            <button class="pdf-btn" type="button" id="savePdfBtn">
              <span>üßæ –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –±—Ä–µ–Ω–¥–æ–≤–∞–Ω–∏–π PDF</span>
            </button>

            <div class="tiny" id="copyStatus"></div>
          </div>
        </aside>

      </div>
    </section>
  </main>

  <footer>¬© Grand Best Performance ¬∑ Auto GBP.</footer>

  <!-- Hidden PDF sheet (rendered into PDF) -->
  <div id="pdf-sheet" aria-hidden="true">
    <div class="pdf-top">
      <div class="pdf-brand">
        <div class="pdf-logo"><img src="logo-gbp.png" alt="Auto GBP"></div>
        <div>
          <div class="pdf-name">AUTO GBP</div>
          <div class="pdf-sub">Grand Best Performance ¬∑ Dubno</div>
        </div>
      </div>
      <div class="pdf-meta">
        <div class="pdf-title">–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤–∞—Ä—Ç–æ—Å—Ç—ñ –∞–≤—Ç–æ ¬´–ø—ñ–¥ –∫–ª—é—á¬ª</div>
        <div class="pdf-small" id="pdf-date">‚Äî</div>
        <div class="pdf-small" id="pdf-route">‚Äî</div>
        <div class="pdf-small" id="pdf-lot">‚Äî</div>
      </div>
    </div>

    <div class="pdf-box">
      <h3>–ë–∞–∑–∞ –¥–ª—è –º–∏—Ç–∞/–ü–î–í —Ç–∞ –ø–æ–¥–∞—Ç–∫–∏</h3>
      <div class="pdf-row"><div class="pdf-left">–ë–∞–∑–∞ –¥–ª—è –º–∏—Ç–∞/–ü–î–í</div><div class="pdf-right" id="pdf-customs-base">‚Äî</div></div>
      <div class="pdf-row"><div class="pdf-left">–ú–∏—Ç–æ</div><div class="pdf-right" id="pdf-duty">‚Äî</div></div>
      <div class="pdf-row"><div class="pdf-left">–ê–∫—Ü–∏–∑ (–æ—Ä—ñ—î–Ω—Ç–æ–≤–Ω–æ)</div><div class="pdf-right" id="pdf-excise">‚Äî</div></div>
      <div class="pdf-row"><div class="pdf-left">–ü–î–í</div><div class="pdf-right" id="pdf-vat">‚Äî</div></div>
      <div class="pdf-total"><div>–ü–æ–¥–∞—Ç–∫–∏ —Ä–∞–∑–æ–º</div><div id="pdf-taxes-total">‚Äî</div></div>
    </div>

    <div class="pdf-box">
      <h3>–î–æ–¥–∞—Ç–∫–æ–≤—ñ –≤–∏—Ç—Ä–∞—Ç–∏ (–Ω–µ –≤—Ö–æ–¥—è—Ç—å —É –º–∏—Ç–æ/–ü–î–í)</h3>
      <div class="pdf-row"><div class="pdf-left">–ü–æ—Ä—Ç–æ–≤—ñ/—Ç–µ—Ä–º—ñ–Ω–∞–ª—å–Ω—ñ</div><div class="pdf-right" id="pdf-port">‚Äî</div></div>
      <div class="pdf-row"><div class="pdf-left">–ü–æ—Å–ª—É–≥–∏ Auto GBP</div><div class="pdf-right" id="pdf-gbp">‚Äî</div></div>
      <div class="pdf-row"><div class="pdf-left">–ë–∞–Ω–∫—ñ–≤—Å—å–∫—ñ –ø–ª–∞—Ç–µ–∂—ñ</div><div class="pdf-right" id="pdf-bank">‚Äî</div></div>
      <div class="pdf-row"><div class="pdf-left">–£–∫—Ä–∞—ó–Ω–∞ + —Å–µ—Ä—Ç/–æ–±–ª—ñ–∫/—Ä–µ–º–æ–Ω—Ç/—ñ–Ω—à–µ</div><div class="pdf-right" id="pdf-extras">‚Äî</div></div>
      <div class="pdf-total"><div>–†–∞–∑–æ–º ¬´–ø—ñ–¥ –∫–ª—é—á¬ª</div><div id="pdf-grand-total">‚Äî</div></div>
      <div class="pdf-small" style="margin-top:6px;color:#b6b6b6;font-size:11px" id="pdf-uah">‚Äî</div>
    </div>

    <div class="pdf-footer">
      <div class="pdf-contacts">
        <div><b>–ö–æ–Ω—Ç–∞–∫—Ç–∏ Auto GBP:</b></div>
        <div>–û—Ñ—ñ—Å: <b>+380955633089</b></div>
        <div>–Ü–Ω—Ñ–æ: <b>+380508232374</b></div>
        <div style="margin-top:8px"><b>–ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫:</b></div>
        <div class="pdf-link" id="pdf-link">‚Äî</div>
      </div>

      <div class="pdf-note">
        * –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –æ—Ä—ñ—î–Ω—Ç–æ–≤–Ω–∏–π. –§–æ—Ä–º—É–ª–∏ —Å–ø—Ä–æ—â–µ–Ω—ñ —Ç–∞ –º–æ–∂—É—Ç—å –Ω–µ –≤—Ä–∞—Ö—É–≤–∞—Ç–∏ –≤—Å—ñ –Ω—é–∞–Ω—Å–∏ –º–∏—Ç–Ω–æ–≥–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è.
        –î–ª—è —Ç–æ—á–Ω–æ–≥–æ —Ñ—ñ–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ä–∞—Ö—É–Ω–∫—É ‚Äî –∑–≤–µ—Ä—Ç–∞–π—Å—è –¥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –∞–±–æ –º–∏—Ç–Ω–æ–≥–æ –±—Ä–æ–∫–µ—Ä–∞.
      </div>
    </div>
  </div>

  <!-- PDF libs (CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

  <script>
    const form = document.getElementById("calc-form");
    const currentYear = new Date().getFullYear();
    const resultCard = document.getElementById("result-card");

    const ELS = {
      customsBase: document.getElementById("customs-base"),
      duty: document.getElementById("duty"),
      excise: document.getElementById("excise"),
      vat: document.getElementById("vat"),
      taxesTotal: document.getElementById("taxes-total"),
      portOnly: document.getElementById("port-only"),
      gbpServices: document.getElementById("gbp-services"),
      bankFees: document.getElementById("bank-fees"),
      extras: document.getElementById("extras"),
      grandTotal: document.getElementById("grand-total"),
      totalUsd: document.getElementById("total-usd"),
      totalUah: document.getElementById("total-uah"),
      routeLine: document.getElementById("route-line"),
      lotLine: document.getElementById("lot-line"),
      auctionStatus: document.getElementById("auctionStatus"),
      copyStatus: document.getElementById("copyStatus"),
    };

    const PARAMS = [
      "auctionUrl","year","fuel","engine","auction",
      "lotPrice","auctionFee","shipUsa","shipSea",
      "euPort","euCurrency","eurUsd","shipEuLand",
      "portFees","shipUa","dealerFee","servicePackage",
      "dutyRate","vatRate","cert","reg","repair","insurance","other",
      "usdToUah",
      "swiftFee","payDocsFee","transferLtFee","legalEntityFee"
    ];

    function num(value){
      if (value === null || value === undefined || value === "") return 0;
      const v = parseFloat(String(value).replace(",", "."));
      return Number.isFinite(v) ? v : 0;
    }
    function fmt(n){ return (Number(n) || 0).toLocaleString("uk-UA",{maximumFractionDigits:0}); }

    function getEUtoUSD(x){
      const cur = form.euCurrency.value;
      if (cur === "EUR"){
        const rate = Math.max(0, num(form.eurUsd.value) || 1.1);
        return x * rate;
      }
      return x;
    }

    function calcExcise({fuel, engine, age}){
      let baseRate;
      if (fuel === "gasoline") baseRate = 50;
      else if (fuel === "diesel") baseRate = 75;
      else if (fuel === "hybrid") baseRate = 25;
      else baseRate = 0;
      if (baseRate <= 0 || engine <= 0) return 0;
      return (engine / 1000) * baseRate * age;
    }

    function pulse(){
      resultCard.classList.remove("pulse");
      void resultCard.offsetWidth;
      resultCard.classList.add("pulse");
    }

    // --- Auction URL parsing ---
    function parseAuctionUrl(url){
      try{
        const u = new URL(url);
        const host = u.hostname.toLowerCase();
        const path = u.pathname;

        if (host.includes("copart.com")){
          const m = path.match(/\/lot\/(\d+)/i);
          if (m) return { auction:"Copart", id:m[1] };
          const q = u.searchParams.get("lotId");
          if (q) return { auction:"Copart", id:q };
        }

        if (host.includes("iaai.com")){
          const m = path.match(/\/VehicleDetail\/(\d+)/i);
          if (m) return { auction:"IAAI", id:m[1] };
          const q = u.searchParams.get("vehicleid") || u.searchParams.get("id");
          if (q) return { auction:"IAAI", id:q };
        }

        return null;
      }catch(e){
        return null;
      }
    }

    function applyAuctionUrl(){
      const url = (form.auctionUrl.value || "").trim();
      if (!url){
        ELS.auctionStatus.textContent = "";
        ELS.lotLine.textContent = "";
        return null;
      }
      const info = parseAuctionUrl(url);
      if (!info){
        ELS.auctionStatus.textContent = "–ù–µ —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤ –ø–æ—Å–∏–ª–∞–Ω–Ω—è. –ü–µ—Ä–µ–≤—ñ—Ä, —â–æ–± —Ü–µ –±—É–≤ Copart/IAAI –ª—ñ–Ω–∫.";
        ELS.lotLine.textContent = "";
        return null;
      }
      form.auction.value = info.auction;
      ELS.auctionStatus.textContent = `–†–æ–∑–ø—ñ–∑–Ω–∞–Ω–æ: ${info.auction} ‚Ä¢ ID: ${info.id}`;
      ELS.lotLine.textContent = `${info.auction} ‚Ä¢ –õ–æ—Ç/ID: ${info.id}`;
      return info;
    }

    // --- Share link (URL) ---
    function buildShareUrl(){
      const u = new URL(window.location.href);
      const sp = new URLSearchParams();

      PARAMS.forEach(k=>{
        const el = form.elements[k];
        if (!el) return;
        const v = (el.value ?? "").toString().trim();
        if (v !== "") sp.set(k, v);
      });

      u.search = sp.toString();
      return u.toString();
    }

    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
        return true;
      }catch(e){
        const ta = document.createElement("textarea");
        ta.value = text; ta.style.position="fixed"; ta.style.left="-9999px";
        document.body.appendChild(ta);
        ta.select();
        try{
          document.execCommand("copy");
          document.body.removeChild(ta);
          return true;
        }catch(err){
          document.body.removeChild(ta);
          return false;
        }
      }
    }

    async function copyShareLink(){
      const link = buildShareUrl();
      const ok = await copyText(link);
      ELS.copyStatus.textContent = ok ? "–ü–æ—Å–∏–ª–∞–Ω–Ω—è —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ ‚úÖ" : "–ù–µ –≤–¥–∞–ª–æ—Å—å —Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è";
      setTimeout(()=>ELS.copyStatus.textContent="", 2200);
    }

    function loadFromUrlParams(){
      const sp = new URLSearchParams(window.location.search);
      if ([...sp.keys()].length === 0) return;

      PARAMS.forEach(k=>{
        const v = sp.get(k);
        const el = form.elements[k];
        if (v !== null && el){
          el.value = v;
        }
      });

      applyAuctionUrl();
    }

    function recalc(){
      const year = parseInt(form.year.value,10) || currentYear;
      const fuel = form.fuel.value;
      const engine = num(form.engine.value);
      const age = Math.max(1, currentYear - year);

      const lotPrice = num(form.lotPrice.value);
      const auctionFee = num(form.auctionFee.value);
      const shipUsa = num(form.shipUsa.value);
      const shipSea = num(form.shipSea.value);

      const shipEuLand = getEUtoUSD(num(form.shipEuLand.value));

      // –ü–æ—Ä—Ç–æ–≤—ñ –ù–ï –≤–∫–ª—é—á–∞—î–º–æ –≤ –º–∏—Ç–æ/–ü–î–í
      const portFees = getEUtoUSD(num(form.portFees.value));

      const shipUa = num(form.shipUa.value);

      // –ü–æ—Å–ª—É–≥–∏ GBP –ù–ï –≤ –º–∏—Ç—ñ
      const dealerFee = num(form.dealerFee.value);
      const servicePackage = num(form.servicePackage.value);

      const dutyRate = num(form.dutyRate.value || 10);
      const vatRate  = num(form.vatRate.value || 20);

      const cert = num(form.cert.value);
      const reg  = num(form.reg.value);
      const repair = num(form.repair.value);
      const insurance = num(form.insurance.value);
      const other = num(form.other.value);

      const usdToUah = num(form.usdToUah.value);

      // –ë–∞–Ω–∫—ñ–≤—Å—å–∫—ñ –ù–ï –≤ –º–∏—Ç—ñ
      const swiftFee = num(form.swiftFee.value);
      const payDocsFee = num(form.payDocsFee.value);
      const transferLtFee = num(form.transferLtFee.value);
      const legalEntityFee = num(form.legalEntityFee.value);

      const excise = calcExcise({fuel, engine, age});

      // ‚úÖ –ë–∞–∑–∞ –¥–ª—è –º–∏—Ç–∞/–ü–î–í
      const customsBase = lotPrice + auctionFee + shipUsa + shipSea + shipEuLand;

      const duty = (customsBase * dutyRate) / 100;
      const vat = ((customsBase + duty + excise) * vatRate) / 100;
      const taxesTotal = duty + vat + excise;

      const gbpServices = dealerFee + servicePackage;
      const bankFees = swiftFee + payDocsFee + transferLtFee + legalEntityFee;
      const extras = shipUa + cert + reg + repair + insurance + other;

      const total = customsBase + taxesTotal + portFees + gbpServices + bankFees + extras;

      ELS.customsBase.textContent = fmt(customsBase) + " $";
      ELS.duty.textContent = fmt(duty) + " $";
      ELS.excise.textContent = fmt(excise) + " $";
      ELS.vat.textContent = fmt(vat) + " $";
      ELS.taxesTotal.textContent = fmt(taxesTotal) + " $";

      ELS.portOnly.textContent = fmt(portFees) + " $";
      ELS.gbpServices.textContent = fmt(gbpServices) + " $";
      ELS.bankFees.textContent = fmt(bankFees) + " $";
      ELS.extras.textContent = fmt(extras) + " $";

      ELS.grandTotal.textContent = fmt(total) + " $";
      ELS.totalUsd.textContent = fmt(total) + " $";

      const euPortText = form.euPort.options[form.euPort.selectedIndex]?.text || "";
      const euCur = form.euCurrency.value;
      ELS.routeLine.textContent =
        `–ú–∞—Ä—à—Ä—É—Ç: –°–®–ê ‚Üí –º–æ—Ä–µ ‚Üí ${euPortText}` + (euCur === "EUR" ? " ‚Ä¢ –Ñ–° –≤–∏—Ç—Ä–∞—Ç–∏: EUR (–∫–æ–Ω–≤–µ—Ä—Ç –≤ USD)" : " ‚Ä¢ –Ñ–° –≤–∏—Ç—Ä–∞—Ç–∏: USD");

      if (usdToUah > 0){
        const totalUah = total * usdToUah;
        ELS.totalUah.textContent = `‚âà ${fmt(totalUah)} –≥—Ä–Ω (–∫—É—Ä—Å ${usdToUah.toFixed(2)})`;
      } else {
        ELS.totalUah.textContent = "";
      }

      pulse();
    }

    function buildSummary(){
      const lines = [
        "Auto GBP ‚Äî –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ (–æ—Ä—ñ—î–Ω—Ç–æ–≤–Ω–æ)",
        "----------------------------------",
        ELS.lotLine.textContent ? ("–õ–æ—Ç: " + ELS.lotLine.textContent) : "",
        ELS.routeLine.textContent || "",
        "",
        "–ë–ê–ó–ê –î–õ–Ø –ú–ò–¢–ê/–ü–î–í: " + ELS.customsBase.textContent,
        "–ú–∏—Ç–æ: " + ELS.duty.textContent,
        "–ê–∫—Ü–∏–∑: " + ELS.excise.textContent,
        "–ü–î–í: " + ELS.vat.textContent,
        "–ü–æ–¥–∞—Ç–∫–∏ —Ä–∞–∑–æ–º: " + ELS.taxesTotal.textContent,
        "",
        "–ü–æ—Ä—Ç–æ–≤—ñ/—Ç–µ—Ä–º—ñ–Ω–∞–ª—å–Ω—ñ: " + ELS.portOnly.textContent,
        "–ü–æ—Å–ª—É–≥–∏ Auto GBP: " + ELS.gbpServices.textContent,
        "–ë–∞–Ω–∫—ñ–≤—Å—å–∫—ñ –ø–ª–∞—Ç–µ–∂—ñ: " + ELS.bankFees.textContent,
        "–£–∫—Ä–∞—ó–Ω–∞ + —Å–µ—Ä—Ç/–æ–±–ª—ñ–∫/—Ä–µ–º–æ–Ω—Ç/—ñ–Ω—à–µ: " + ELS.extras.textContent,
        "",
        "–†–ê–ó–û–ú –ü–Ü–î –ö–õ–Æ–ß: " + ELS.grandTotal.textContent,
        ELS.totalUah.textContent ? ELS.totalUah.textContent : "",
        "",
        "–ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫:",
        buildShareUrl()
      ];
      return lines.filter(Boolean).join("\n");
    }

    async function copySummary(){
      const ok = await copyText(buildSummary());
      ELS.copyStatus.textContent = ok ? "–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ ‚úÖ" : "–ù–µ –≤–¥–∞–ª–æ—Å—å —Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏";
      setTimeout(()=>ELS.copyStatus.textContent="", 2200);
    }

    // ---------- Branded PDF ----------
    function pad2(n){ return String(n).padStart(2,"0"); }
    function nowStamp(){
      const d = new Date();
      return `${pad2(d.getDate())}.${pad2(d.getMonth()+1)}.${d.getFullYear()} ${pad2(d.getHours())}:${pad2(d.getMinutes())}`;
    }

    function fillPdfSheet(){
      // meta
      document.getElementById("pdf-date").textContent = "–î–∞—Ç–∞: " + nowStamp();
      document.getElementById("pdf-route").textContent = ELS.routeLine.textContent || "‚Äî";
      document.getElementById("pdf-lot").textContent = ELS.lotLine.textContent ? ("–õ–æ—Ç: " + ELS.lotLine.textContent) : "–õ–æ—Ç: ‚Äî";

      // numbers
      document.getElementById("pdf-customs-base").textContent = ELS.customsBase.textContent;
      document.getElementById("pdf-duty").textContent = ELS.duty.textContent;
      document.getElementById("pdf-excise").textContent = ELS.excise.textContent;
      document.getElementById("pdf-vat").textContent = ELS.vat.textContent;
      document.getElementById("pdf-taxes-total").textContent = ELS.taxesTotal.textContent;

      document.getElementById("pdf-port").textContent = ELS.portOnly.textContent;
      document.getElementById("pdf-gbp").textContent = ELS.gbpServices.textContent;
      document.getElementById("pdf-bank").textContent = ELS.bankFees.textContent;
      document.getElementById("pdf-extras").textContent = ELS.extras.textContent;

      document.getElementById("pdf-grand-total").textContent = ELS.grandTotal.textContent;
      document.getElementById("pdf-uah").textContent = ELS.totalUah.textContent ? ("–ü—ñ–¥—Å—É–º–æ–∫ —É –≥—Ä–∏–≤–Ω—ñ: " + ELS.totalUah.textContent) : "";

      document.getElementById("pdf-link").textContent = buildShareUrl();
    }

    async function saveBrandedPdf(){
      try{
        if (!window.html2canvas || !window.jspdf?.jsPDF) {
          ELS.copyStatus.textContent = "–ù–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏–ª–∏—Å—å –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ PDF. –ü–µ—Ä–µ–≤—ñ—Ä —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç/–±–ª–æ–∫—É–≤–∞–ª—å–Ω–∏–∫.";
          setTimeout(()=>ELS.copyStatus.textContent="", 2600);
          return;
        }

        fillPdfSheet();
        const sheet = document.getElementById("pdf-sheet");

        // render
        ELS.copyStatus.textContent = "–ì–æ—Ç—É—é PDF‚Ä¶";
        const canvas = await html2canvas(sheet, {
          scale: 2,
          backgroundColor: "#07080d",
          useCORS: true
        });

        const imgData = canvas.toDataURL("image/png");

        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF("p", "mm", "a4");

        // A4 size in mm: 210 x 297
        const pageW = 210;
        const pageH = 297;

        // Fit image to page with margins
        const margin = 8;
        const imgW = pageW - margin*2;
        const imgH = (canvas.height * imgW) / canvas.width;

        let y = margin;
        pdf.addImage(imgData, "PNG", margin, y, imgW, imgH, undefined, "FAST");

        // file name
        const info = parseAuctionUrl((form.auctionUrl.value||"").trim());
        const id = info?.id ? info.id : "calc";
        const auc = info?.auction ? info.auction : "AutoGBP";
        const d = new Date();
        const fn = `${auc}_AutoGBP_${id}_${d.getFullYear()}-${pad2(d.getMonth()+1)}-${pad2(d.getDate())}.pdf`;

        pdf.save(fn);

        ELS.copyStatus.textContent = "PDF –∑–±–µ—Ä–µ–∂–µ–Ω–æ ‚úÖ";
        setTimeout(()=>ELS.copyStatus.textContent="", 2200);
      }catch(e){
        ELS.copyStatus.textContent = "–ù–µ –≤–¥–∞–ª–æ—Å—å –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ PDF. –°–ø—Ä–æ–±—É–π —â–µ —Ä–∞–∑.";
        setTimeout(()=>ELS.copyStatus.textContent="", 2600);
      }
    }

    // events
    form.querySelectorAll("input,select").forEach(el=>{
      el.addEventListener("input", recalc);
      el.addEventListener("change", recalc);
    });

    document.getElementById("scrollToResult").addEventListener("click", ()=>{
      document.getElementById("result-card").scrollIntoView({behavior:"smooth",block:"start"});
    });

    document.getElementById("applyAuctionUrlBtn").addEventListener("click", ()=>{
      applyAuctionUrl();
      recalc();
    });

    document.getElementById("copyLinkBtn").addEventListener("click", copyShareLink);
    document.getElementById("copyLinkBtn2").addEventListener("click", copyShareLink);

    document.getElementById("copySummaryBtn").addEventListener("click", copySummary);

    document.getElementById("savePdfBtn").addEventListener("click", ()=>{
      document.getElementById("result-card").scrollIntoView({ behavior:"smooth", block:"start" });
      setTimeout(saveBrandedPdf, 200);
    });

    // init
    loadFromUrlParams();
    applyAuctionUrl();
    recalc();
  </script>
</body>
</html>
